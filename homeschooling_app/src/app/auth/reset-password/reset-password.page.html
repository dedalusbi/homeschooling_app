<ion-header mode="ios" class="ion-no-border [--background:theme(colors.fundo-neutro)]">
  <ion-toolbar class="[--background:theme(colors.fundo-neutro)]">
    <ion-buttons slot="start">
      <!--Volta para a tela de login se o usuário desistir-->
      <ion-back-button defaultHref="/auth/login" class="text-texto-profundo"></ion-back-button>
    </ion-buttons>
    <ion-title class="text-texto-profundo text-center">Alterar Senha</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="[--background:theme(colors.fundo-neutro)]">

  <!--Container centralizado e com largura máxima em telas maiores-->
  <div class="p-6 text-texto-profundo flex flex-col h-full md:max-w-md md:mx-auto md:justify-center">

    <!--Ícone e título-->
    <div class="text-center mt-8 md:mt-0 mb-8">
      <div class="w-16 h-16 bg-blue-100 rounded-full inline-flex items-center justify-center">
        <ion-icon class="text-azul-sereno text-3xl" name="shield-checkmark"></ion-icon>
      </div>
      <h1 class="text-2xl font-bold mb-2">Redefina sua senha</h1>
      <p class="text-texto-suave px-4">
        Escolha uma nova senha segura para proteger sua conta (mínimo 6 caracteres).
      </p>
    </div>

    <!--Formulário-->
    <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" class="space-y-5">
      <!--Nova senha-->
      <div class="bg-white rounded-lg p-3 shadow-sm">
        <ion-label position="stacked" class="text-xs text-texto-suave mb-1 ml-1">Nova Senha</ion-label>
        <div class="flex items-center">
          <ion-input [type]="showPassword ? 'text' : 'password'" placeholder="Digite sua nova senha" formControlName="password" class="flex-grow text-base"></ion-input>
          <ion-icon [name]="showPassword ? 'eye-off' : 'eye'" class="text-texto-suave text-xl ml-2 cursor-pointer" (click)="togglePassword()"></ion-icon>
        </div>
        <!--Erro-->
        <div *ngIf="f['password'].invalid && f['password'].touched" class="text-vermelho-erro text-xs ml-1 mt-1">
          <span *ngIf="f['password'].errors?.['required']">Nova senha é obrigatória.</span>
          <span *ngIf="f['password'].errors?.['minlength']">Senha deve ter no mínimo 6 caracteres.</span>
        </div>
      </div>

      <!--Confirmar nova senha-->
      <div class="bg-white rounded-lg p-3 shadow-sm">
          <ion-label position="stacked" class="text-xs text-texto-suave mb-1 ml-1">Confirmar Nova Senha</ion-label>
          <div class="flex items-center">
            <ion-input [type]="showConfirmPassword ? 'text' : 'password'" placeholder="Confirme sua nova senha" formControlName="confirmPassword" class="flex-grow text-base"></ion-input>
            <ion-icon [name]="showConfirmPassword ? 'eye-off' : 'eye'" class="text-texto-suave text-xl ml-2 cursor-pointer" (click)="toggleConfirmPassword()"></ion-icon>
          </div>
          <!--Erro de confirmação-->
          <div *ngIf="resetPasswordForm.hasError('mismatch') && f['confirmPassword'].touched" class="text-vermelho-erro text-xs mt-1 ml-1">
            As senhas não coincidem.
          </div>
      </div>


      <!--Botão redefinir-->
      <ion-button type="submit" expand="block" shape="round" class="h-12 text-base normal-case [--background:theme(colors.azul-sereno)] text-white hover:bg-opacity-90 mt-10" [disabled]="resetPasswordForm.invalid">
        <ion-icon name="checkmark-circle" slot="start"></ion-icon>
        Redefinir Senha
      </ion-button>

    </form>

    <!--Espaço no final (se necessário para layout mobile)-->
    <div class="mt-auto pt-8 pb-4"></div>

  </div>

</ion-content>
